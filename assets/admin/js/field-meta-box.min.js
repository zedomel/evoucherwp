jQuery(document).ready(function(a){var b,c,d=wp.media.model.settings.post.id;jQuery("#evoucherwp_template_cb").change(function(){var a=jQuery("#evoucherwp_template_cb option:selected");a.length>0&&""!=a.val()&&jQuery.ajax({type:"POST",dataType:"json",url:url,data:{action:"select_template",template_id:a.val()},success:function(a){if(a.valid){var e=jQuery("#evoucherwp_fields");e.empty(),jQuery.each(a.fields,function(a,b){if("evoucherwp_guid_field"!=b.id){var c='<div class="inside">',d=b.id.substr(b.id.indexOf("_")+1)+": ";"span"==b.type?(c+='<label for="'+b.id+'">'+d,c+='<input id="'+b.id+'" name="'+b.id+'" type="text"></label>'):"img"==b.type&&(c+='<div class="image-preview-wrapper">',c+="<p>"+d+'<img class="image-preview" src="" >',c+='<input type="hidden" class="input-image"  name="'+b.id+'" id="'+b.id+'" value="">',c+='<input id="upload_image_button" type="button" class="button" value="Select Media"/></p>',c+="</div>"),c+="</div>",e.append(c)}}),jQuery("#upload_image_button").on("click",function(a){return a.preventDefault(),b?(b.uploader.uploader.param("post_id",c),void b.open()):(wp.media.model.settings.post.id=c,b=wp.media.frames.file_frame=wp.media({title:"Select a image",button:{text:"Use this image"},multiple:!1}),b.on("select",function(){attachment=b.state().get("selection").first().toJSON();var c=jQuery(a.target).prev(".input-image");c.val(attachment.id);c.prev(".image-preview").attr("src",attachment.url);wp.media.model.settings.post.id=d}),void b.open())})}else jQuery(".change-voucher").prepend('<div class="woocommerce-message">'+a.message+"</div>")}})})});